---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by Administrator.
--- DateTime: 2021/11/4 10:32
---
local ComponentDefine = require("Engine/Systems/ObjectSystem/Components/ComponentDefine")
local ComponentBag = class("ComponentBag", ComponentBase)
ComponentBag.m_ComponentId = ComponentDefine.ComponentType.k_ComponentBag

function ComponentBag:Init(object)
    ComponentBag.__super.Init(self, object)
end

function ComponentBag:Deserialize(netBuffer)
    self:DeserializeItemUseTime(netBuffer)
    local bag_count = netBuffer:ReadUByte()
    for i = 1, bag_count do
        self:DeserializeSubBag(netBuffer)
    end
    self:DeserializeEquippedItem(netBuffer)
end

function ComponentBag:DeserializeItemUseTime(netBuffer)
    local item_count = netBuffer:ReadInt()
    for i = 1, item_count do
        local use_cd_id = netBuffer:ReadInt()
        local use_time = netBuffer:ReadInt()
    end
end

function ComponentBag:DeserializeEquippedItem(netBuffer)
    self:DeserializeItem(netBuffer)
end

function ComponentBag:DeserializeSubBag(netBuffer)
    local type_ = netBuffer:ReadUByte()
    local max_capacity_ = netBuffer:ReadUShort()
    local capacity_ = netBuffer:ReadUShort()
    self:DeserializeItem(netBuffer)
end

function ComponentBag:DeserializeItem(netBuffer)
    local item_count = netBuffer:ReadUShort()
    for i = 1, item_count do
        ComponentBag.DeserializeSingleItem(netBuffer)
    end
end

function ComponentBag.DeserializeSingleItem(netBuffer)
    ---unserialize_common()
    local item_id_ = netBuffer:ReadInt()
    local item_num_ = netBuffer:ReadInt()
    local is_bind_ = netBuffer:ReadUByte()
    local sn_ = netBuffer:ReadUInt()
    local item_uid_ = netBuffer:ReadInt()
    local item_pos_ = netBuffer:ReadInt()

    ---unserialize_attr()
    local count = netBuffer:ReadUShort()
    for i = 1, count do
        local attr = netBuffer:ReadInt()
    end


    ---unserialize_equip()
    local has_attr = netBuffer:ReadUByte()
    local can_equip_ = false
    if has_attr ~= 0 then
        can_equip_ = true
    end


    ---base_attr_
    count = netBuffer:ReadUByte()
    for i = 1, count do
        local attr_id = netBuffer:ReadInt()
        local attr_value = netBuffer:ReadFloat()
    end

    ---extra_attr_
    count = netBuffer:ReadUByte()
    for i = 1, count do
        local attr_id = netBuffer:ReadInt()
        local attr_value = netBuffer:ReadFloat()
    end

    ---effect_attr_
    count = netBuffer:ReadUByte()
    for i = 1, count do
        local attr_id = netBuffer:ReadInt()
        local attr_value = netBuffer:ReadFloat()
    end
end

function ComponentBag:DeserializeWareHouse(netBuffer)
    local unlock_num_ = netBuffer:ReadUByte()
    for i = 1,unlock_num_ do
        local index_ = netBuffer:ReadUByte()
        local capacity_ = netBuffer:ReadInt()
        local item_count = netBuffer:ReadInt()
        for i = 1, item_count do
            ComponentBag.DeserializeSingleItem(netBuffer)
        end
    end
end

return ComponentBag