---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by Administrator.
--- DateTime: 2021/3/26 11:16
---

local SGMissileStage = require("Engine/Systems/ObjectSystem/SGMissile/SGMissileStage")
local SGMissileStageTrack = class("SGMissileStageTrack", SGMissileStage)

function SGMissileStageTrack:Ctor(stageConfig, index)
    SGMissileStageTrack.__super.Ctor(self, stageConfig, index)
end

function SGMissileStageTrack:Start(missileObj, startPosition, startAngle)
    SGMissileStageTrack.__super.Start(self, missileObj, startPosition, startAngle)
    self.m_StartAngle = startAngle
    self:OnSetTarget()
end

function SGMissileStageTrack:Exit()
    self.m_Owner.m_Core:StopTrackMove()
end

function SGMissileStageTrack:OnSetTarget()
    local owner = self.m_Owner
    local targetObjId = owner:GetTargetId()
    if not targetObjId then
        return
    end

    local obj = ObjectManager.GetObject(targetObjId)
    if not obj then
        return
    end
    local hangPointName = self.m_Config.TracePoint
    owner.m_Core:BeginTrackMove(targetObjId, self.m_MoveSpeed, self.m_RotateSpeed, hangPointName)
end

return SGMissileStageTrack